# 3.1 IP アドレス、バージョン4と6

ベン・ケノービがまだオビワン・ケノービと呼ばれていた頃、インターネット・プロトコル・バージョン4（IPv4）と呼ばれる素晴らしいネットワーク・ルーティング・システムが存在しました。IPv4 は 4 バイト（4オクテット）で構成されるアドレスで、一般に "ドットと数字" で表記されるのが一般的でした。`192.0.2.111` のように。

皆さんも一度は目にしたことがあるのではないでしょうか。

実際、この記事を書いている時点では、インターネット上のほぼすべてのサイトが IPv4 を使っています。

オビ・ワンをはじめ、誰もが幸せでした。しかし、ヴィント・サーフという名の否定的な人物が、IPv4 アドレスが足りなくなると警告を発したのです！

（[ヴィント・サーフ](https://en.wikipedia.org/wiki/Vint_Cerf)氏は、IPv4 による "破滅と暗黒の黙示録" の到来を警告するとともに、"インターネットの父" としても有名です。だから、私は彼の判断に二の足を踏む立場にはないのです。）

アドレスが足りなくなる？そんなことがあるのでしょうか？つまり、32ビットの IPv4 アドレスには何十億もの IP アドレスが存在するのです。本当に何十億台ものコンピュータがあるのでしょうか？

Yes.

また、コンピュータが数台しかなく、10億という数字があり得ないほど大きいと誰もが思っていた当初、いくつかの大きな組織は、自分たちが使うために何百万という IP アドレスを惜しげもなく割り当てていたのです。（ゼロックス、MIT、フォード、HP、IBM、GE、AT&T、そしてアップルという小さな会社などです。）

実際、いくつかの応急処置がなかったら、とっくに使い果たしていたでしょう。

しかし今は、すべての人間が IP アドレスを持ち、すべてのコンピュータ、電卓、電話、パーキングメーター、そして（なぜか）子犬も、という時代です。

そして、IPv6 が誕生したのです。ヴィント・サーフはおそらく不死身なので（たとえ肉体がこの世を去ったとしても、おそらく彼はすでにインターネット2の奥深くにある超知的な [ELIZA](https://en.wikipedia.org/wiki/ELIZA) プログラムとして存在しているはずです）、もし次のバージョンのインターネットプロトコルで十分なアドレスが確保できなければ、誰も彼の "だから言っただろう" という言葉を再び聞きたくはないでしょう。

これは何を示唆しているのでしょうか？

もっとたくさんのアドレスが必要だということです。2倍どころか10億倍でもなく1000兆倍でもなく 7900万ビリオン・トリリオンの数のアドレスが必要なのです！そうこなくちゃ！

"Beej、それは本当なの？大きな数字を信じない理由があるんだ。" 32ビットと128ビットの差は大したことないように聞こえるかもしれない、96ビット多いだけだろ？しかし、私たちはここで累乗の話をしていることを忘れてはなりません。32ビットは約40億の数字（\\(2^{32}\\)）を表し、128ビットは約340兆の数字（\\(2^{128}\\)）を表します。これは、宇宙の星1つに対して、100万個の IPv4 インターネットがあるようなものです。

IPv4 のドットや数字も忘れて、16進数では、2バイトの塊をコロンで区切って、このように表現しています。

```
2001:0db8:c9d2:aee5:73e3:934a:a5ae:9551
```

それだけではありません！多くの場合、IP アドレスにはたくさんのゼロが含まれていますが、それらを2つのコロンで区切って圧縮することができます。そして、各バイトペアの先頭のゼロを省くことができます。例えば、次のようなアドレスのペアは、それぞれ等価です。

```
2001:0db8:c9d2:0012:0000:0000:0000:0051
2001:db8:c9d2:12::51

2001:0db8:ab00:0000:0000:0000:0000:0000
2001:db8:ab00::

0000:0000:0000:0000:0000:0000:0000:0001
::1
```

アドレス `::1` はループバックアドレスです。常に "今使っているこのマシン" という意味です。IPv4 では、ループバックアドレスは `127.0.0.1` です。

最後に、IPv6 アドレスの IPv4 互換モードですが、これは皆さんが遭遇する可能性のあるものです。例えば、`192.0.2.33`という IPv4 アドレスを IPv6 アドレスとして表現したい場合、次のような表記をします。"`::ffff:192.0.2.33`"。

本気で楽しみたいんです。

実際、IPv6 の開発者たちは、何兆個ものアドレスを軽率にも予約用に切り捨てたほど、IPv6 は楽しいものなのですが、数が多すぎて、正直言って、もう誰が数えているのでしょうか？銀河系のすべての惑星のすべての男性、女性、子供、子犬、そしてパーキングメーターのために十分な数が残されています。 信じてくれ、銀河系のどの星にもパーキングメーターはあるんだ。本当なんだ。
